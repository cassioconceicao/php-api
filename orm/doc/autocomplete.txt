<style type="text/css">
    #$name-label {color: $textColor;width: 95%;border-radius: 5px;border: 1px solid $borderColor;font-size: 16px;padding: 5px;font-size: $fontSize;margin-bottom: 12px}
    #$name-list a {color: $textColor;display: block;padding: 5px;text-decoration: none;font-size: $fontSize}
    #$name-list a:nth-child(even) {background: $backgroundColor}
    #$name-list a:nth-child(odd) {background: $rowColor}
    #$name-list a:hover {background-color: $highlightColor}
</style>
<script type="text/javascript">

    function search$className(term) {

        var sel = document.getElementById('$name-list');

        if (term.length > 0) {

            sel.innerHTML = "";
            sel.style.border = "none";

            var ajax = typeof XMLHttpRequest !== 'undefined' ? new XMLHttpRequest() : new ActiveXObject('Microsoft.XMLHTTP');
            ajax.open('POST', '$url');
            ajax.setRequestHeader('Content-type', 'application/x-www-form-urlencoded');
            ajax.responseType = 'json';

            ajax.onreadystatechange = function () {

                if (this.readyState === 4 && this.status === 200) {

                    if (typeof ajax.response.error !== 'undefined') {
                        sel.innerHTML = "";
                        alert(ajax.response.error);
                    } else if (ajax.response.length > 0) {
                        var list = "";
                        for (const op of ajax.response) {
                            list += "<a href=\"javascript:setSeleceted$className('" + op.value + "', '" + op.label + "')\">" + op.label + "</a>";
                        }
                        sel.innerHTML = list;
                        sel.style.border = "1px solid $borderColor";

                    } else {
                        sel.innerHTML = "";
                        sel.style.border = "none";
                    }

                } else {
                    sel.innerHTML = "";
                    sel.style.border = "none";
                }
            };

            ajax.send('action=find&term=' + term + '&limit=' + 8);
        } else {
            sel.innerHTML = "";
            sel.style.border = "none";
        }
    }

    function setSeleceted$className(value, label) {
        document.getElementById('$name').value = value;
        document.getElementById('$name-label').value = label;
        document.getElementById('$name-list').innerHTML = "";
        document.getElementById('$name-list').style.border = "none";
    }

</script>
<input id="$name-label" onkeyup="search$className(this.value)" size="60" />
<input type="hidden" id="$name" name="data[$name]" value="$value" />
<div id="$name-list"></div>
<script type="text/javascript">
    
    if(!isNaN(document.getElementById('$name').value) && document.getElementById('$name').value.length > 0) {

        var ajax = typeof XMLHttpRequest !== 'undefined' ? new XMLHttpRequest() : new ActiveXObject('Microsoft.XMLHTTP');
        ajax.open('POST', '$url');
        ajax.setRequestHeader('Content-type', 'application/x-www-form-urlencoded');
        ajax.responseType = 'json';

        ajax.onreadystatechange = function () {
            if (this.readyState === 4 && this.status === 200) {
                if (typeof ajax.response.error !== 'undefined') {
                    alert(ajax.response.error);
                } else {
                    document.getElementById('$name-label').value = ajax.response.label;
                }
            }
        };

        ajax.send('action=find&id=' + document.getElementById('$name').value);
    }

</script>
